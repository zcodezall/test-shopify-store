<script>
  const url = 'https://next-level-app.gadget.app/hi';

  // Function to handle form submission
  const handleSubmit = (event) => {
    event.preventDefault();

    // Get the email input value
    const userEmail = document.getElementById('emailInput').value;

    // Create the request data object
    const requestData = {
      userEmail: userEmail,
    };

    // Make the API request
    fetch(url, {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
      },
      body: JSON.stringify(requestData),
    })
      .then(response => response.json())
      .then(data => {
        // Handle the response data
        console.log(data);
        // Clear existing orders before rendering new ones
        document.getElementById('ordersContainer').innerHTML = '';

        // Check if there are any orders
        if (data.hello) {
          let orderHtml = `<label class="main-orders-label"> ORDERS</label>
                              <div class="tov-customer-orders">`;
        
          Object.entries(data.hello).forEach(([key, value]) => {
            const orderNumber = value.orderCONumber;
            const orderDate = value.orderDate;
            const orderStatus = value.orderStatus;
            let images = '';
            console.log(Object.entries(value['itemsData']);
            Object.entries(value['itemsData']).forEach(([key, value]) => {
            if(key == 'imageURL'){
              images += `<img src=${value} />`;
            }

            });
         
            // Generate HTML output for each order
            orderHtml += `
              <div class="tov-dashb-single-order-container">
              <div>
                <h3>Order: ${orderNumber}</h3>
                <p>Order Date: ${orderDate}</p>
                <p>Order Status: ${orderStatus}</p>
                <div>${images}</div>
                <!-- ...other data fields -->
              </div>
              </div>
            `;
           
            // Append the HTML to the orders container
            
          });
          orderHtml += `</div>`;
          document.getElementById('ordersContainer').innerHTML += orderHtml;
        } else {
          // No orders found
          document.getElementById('ordersContainer').innerHTML = 'No orders found for the provided email.';
        }
      })
      .catch(error => {
        // Handle any errors
        console.error('Error:', error);
        // Display an error message
        document.getElementById('ordersContainer').innerHTML = 'Error occurred while fetching orders.';
      });
  };

  // Add event listener to the form
  document.addEventListener('DOMContentLoaded', function() {
    document.getElementById('emailForm').addEventListener('submit', handleSubmit);
  });
</script>

<div>
  <form id="emailForm">
    <label for="emailInput">Email:</label>
    <input type="email" id="emailInput" required>
    <button type="submit">Submit</button>
  </form>
</div>

<div id="ordersContainer">Orders will be displayed here.</div>
